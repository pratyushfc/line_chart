!function(){"use strict";function t(t){t=t||{},this.height=t.height||500,this.width=t.width||300,this.shrink=t.shrink||.81,this.range=t.range,this.readFn=t.readFn,this.isVertical=t.isVertical,this.isRangeBasic=t.basicRange||!1,this.displayFn=t.displayFn||function(t){return t},this.alignment=t.alignment||"",this.__getRangeArray__()}function e(t,e){}function i(t,e){this.renderEngine=t,this.tooltip=new u,this.columnWidth=e,this.columnsObject=[]}function r(t,e){this.renderEngine=t,this.columnWidth=e,this.columnsObject=[]}function n(t){this.model=t}function a(t){this.model=t;var e=2+t.getZones().length,i=window.innerWidth/e*1.2,r=.6*i;this.dimension={width:i,height:r},this.numSvgs=e}function s(t){return t=t.getBoundingClientRect(),{left:t.left+window.scrollX,top:t.top+window.scrollY}}function o(t,e){var i,r=0,n=0,a=0,s="",o=t.length,h=[["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["Mo","Tu","We","Th","Fr","Sa","Su"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]],l=!0,c=!0,u=!0,d=[],e=e||function(t){return t};for(r=o;r--&&(i=e(t[r]),(l&&"string"!=typeof i||isNaN(+new Date(i)))&&(l=!1),l&&3!==i.split("-").length&&(l=!1),c&&"number"!=typeof i&&(c=!1),l||c););if(l)return"date";if(c)return"numeric";for(y(d,!1,o),a=h.length,n=0;n<a;++n){for(i=h[n],n&&y(d,!1),u=!0,r=0;r<o;++r){if(s=e(t[r])+"",s["in"](i)===!1){u=!1;break}d[s["in"](i)]=!0}if(u)return v(i,d)}return t}function h(t){this.renderEngine=t,this.plotCirclesObject={},this.tooltip=new u,this.plotCircleRadius=this.renderEngine.plotCircleRadius;var e,i=this;this.renderEngine.svg.addEventListener("mousemove",function(t){e=new CustomEvent("mousexmovement",{detail:{positionx:t.clientX-b(i.renderEngine.svg).left}}),document.dispatchEvent(e)}),this.renderEngine.svg.addEventListener("mouseout",function(t){e=new CustomEvent("mousexmovement",{detail:{positionx:-1}}),document.dispatchEvent(e)});var i=this;document.addEventListener("mousexmovement",function(t){i.behave(t.detail.positionx)})}function l(t){var e,i,r,n,a;if("string"==typeof t&&(t=JSON.parse(t)),this.data={},this.data.dimensions={width:500,height:600},this.data.ticks={xaxis:5,yaxis:5},this.interpolation=!0,t.interpolation===!1&&(this.interpolation=!1),this.type=t.type||"line",this.data.caption=t.caption||"",this.data.subcaption=t.subcaption||"",this.data.xaxisname=t.xaxisname||"Time",this.data.variables=t.variables||[],this.data.separator=t.separator||"|",this.data.category={},this.data.dateArray=[],t.interpolation===!1&&(this.interpolation=!1),t.dimensions&&(this.data.dimensions.width=t.dimensions.width||this.data.dimensions.width,this.data.dimensions.height=t.dimensions.height||this.data.dimensions.height),t.ticks&&(this.data.ticks.xaxis=t.ticks.xaxis||this.data.ticks.xaxis,this.data.ticks.yaxis=t.ticks.yaxis||this.data.ticks.yaxis),Array.isArray(t.data))for(e=0,i=t.data.length;e<i;++e){n=t.data[e],a=new Date(n.time);for(r in n)if("time"!==r){this.data.category[r]=this.data.category[r]||[];var s=_(a.getYear(),a.getMonth());this.data.category[r].push({year:a.getYear(),month:a.getMonth(),value:n[r],date:s,time:n.time})}this.data.dateArray.indexOf(n.time)===-1&&this.data.dateArray.push(n.time)}for(r in this.data.category)this.data.category[r].sort(x);this.data.dateArray.sort(x)}function c(t){this.data=t,this.__crunch__()}function u(){this.toolEl=document.createElement("div"),document.body.appendChild(this.toolEl),this.toolEl.setAttribute("class","plotTooltip"),this.style="position:absolute;top:-100px;left:-100px;visibility:";var t="hidden";this.toolEl.setAttribute("style",this.style+t)}function d(t,e,i,r,n,a,s){this.isLabelTop=n,this.engine=t,this.key=r,this.width=i.width||600,this.height=i.height||500,this.rootElement=document.getElementById(e),this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("height",this.height),this.svg.setAttribute("width",this.width),this.svg.setAttribute("class",a||"chart"),this.rootElement.appendChild(this.svg),this.marginX=.13*this.width,this.isLabelTop?this.marginY=.2*this.height:this.marginY=.1*this.height,this.shiftRatioX=.81,this.shiftRatioY=.7,this.plotCircleRadius=5,this.xCoords={},s||this.__dragListener__()}function g(e){t.call(this,e)}function p(e,i,r){t.call(this,e,i,r)}function m(e){e.isVertical=!0,t.call(this,e)}function f(e,i,r){var n=r?r.length-1:1;t.call(this,e,i,{min:0,max:n},!0),this.rangeArray=r}window.MultiVariantChart=function(t,e){var i=performance.now();if(t.crosstab){var r=new c(t);this.engine=new a(r),document.getElementById(e).setAttribute("id",e+"cross"),this.engine.render(e+"cross")}else{var r=new l(t);this.engine=new n(r),this.engine.render(e,r.getType())}console.log("rendered in ",performance.now()-i," mili seconds")},MultiVariantChart.prototype.sort=function(t){this.engine.rearrange(t)},MultiVariantChart.prototype.reverse=function(t){this.engine.reverse()},window.Sort={average:function(t){var e,i=0;for(e=t.length;--e;)i+=t[e].value;return i/t.length},min:function(t){var e,i=t[0].value;for(e=t.length;--e;)i>t[e].value&&(i=t[e].value);return i},max:function(t){var e,i=t[0].value;for(e=t.length;--e;)i<t[e].value&&(i=t[e].value);return i},shuffle:function(t){return Math.random()-Math.random()}},t.prototype.estimateRange=function(t){var e,i=this.rangeArray;return this.isNumericType?e=(t-this.min)/(this.max-this.min):(t+="",e=t["in"](i,this.readFn)/(i.length-1)),this.isVertical?this.shrink*e*this.height:this.shrink*e*this.width},t.prototype.plotAxis=function(t,e){var i=0,r=this.width*this.shrink,n=0,a=0;e=e||"axis",this.isVertical&&(i=0,r=0,n=0,a=this.shrink*this.height),t.drawLine(i,n,r,a,e)},t.prototype.__getRangeArray__=function(){if(this.rangeArray)return this.rangeArray;var t=0,e=0,i=this.range,r=(i.length,this.readFn),n=o(i,this.readFn);return"date"===n||"numeric"===n?(this.isNumericType=!0,t=Math.min.apply(null,O(i,r)),e=Math.max.apply(null,O(i,r)),this.rangeArray=L({min:t,max:e,basic:this.isRangeBasic}),this.min=this.rangeArray[0],this.max=this.rangeArray[this.rangeArray.length-1]):(this.isNumericType=!1,this.rangeArray=n),this.rangeArray},t.prototype.plotTicks=function(t){var e,i,r,n,a,s,o,h=this.__getRangeArray__();for(e=0,i=h.length;e<i;++e)r=h[e],this.isVertical?(n=-6,a=0,s=this.estimateRange(r),o=s):(n=this.estimateRange(r),a=n,s=-6,o=0),t.drawLine(n,s,a,o,"ticks")},t.prototype.placeLabel=function(t,e){var i,r=0,n=0,a=0,s=0,o="",h=this.__getRangeArray__(),l=this.alignment;for(this.labelArray||(this.labelArray=[]),e&&(s=t.yaxis.shrink*this.height,l="center-horizontal up"),r=0,n=h.length;r<n;++r)i=h[r],i="number"==typeof i?Math.round(i):this.readFn(i),this.isVertical?s=this.estimateRange(i):a=this.estimateRange(i),o=this.displayFn(i),o.indexOf("b")!==-1&&console.log(i,o),this.labelArray[r]=t.__placeText(a,s,o,"axis-label xaxis-label",null,l)},t.prototype.removeLabel=function(t){var e,i=0,r=0;if(this.labelArray)for(i=0,r=this.labelArray.length;i<r;++i)e=this.labelArray[i],e&&(t.removeElement(e),this.labelArray[i]=void 0)},e.prototype.renderData=function(t,e){},e.prototype.highlight=function(t,e,i,r){},e.prototype.behaveColumnOver=function(t,e){},i.prototype=Object.create(e.prototype),i.prototype.renderData=function(t,e){var i,r,n,a;for(i=0,r=t.length;i<r;++i){n=t[i],a=e[i];var s=this.renderEngine.xaxis.estimateRange(n)-this.columnWidth/2,o=this.renderEngine.yaxis.estimateRange(a),h=this.renderEngine.drawRect(s,o,this.columnWidth,o,"data-column");this.columnsObject.push({x1:Math.floor(h.getAttribute("x")),x2:Math.floor(Number(h.getAttribute("x"))+this.columnWidth),y:Math.floor(h.getAttribute("y")),value:a,element:h});var l,c=this;h.addEventListener("mousemove",function(t){l=new CustomEvent("columnover",{detail:{positionx:t.clientX-b(c.renderEngine.svg).left,positiony:t.pageY-b(c.renderEngine.svg).top}}),document.dispatchEvent(l)}),h.addEventListener("mouseout",function(t){l=new CustomEvent("columnover",{detail:{positionx:-1,positiony:-1}}),document.dispatchEvent(l)}),document.addEventListener("columnover",function(t){c.behaveColumnOver(t.detail.positionx,t.detail.positiony)})}},i.prototype.highlight=function(t,e,i,r){var n,a,s,o,h;for(n=this.columnsObject.length;n--;)a=this.columnsObject[n],s=a.x1>=t&&a.x1<=i,o=a.x2>=t&&a.x2<=i,h=a.y<=r,h&&(s||o)?(a.element.setAttribute("class","data-column data-column-hover"),a.hoverProtected=!0):(delete a.hoverProtected,a.element.setAttribute("class","data-column"))},i.prototype.behaveColumnOver=function(t,e){t===-1?this.__loseFocus__():this.__focus__(t,e)},i.prototype.__focus__=function(t,e){var i=b(this.renderEngine.svg).top,r=b(this.renderEngine.svg).left;if(!(t<this.renderEngine.marginX)){var n=this.__findRectAtPoint(t);if(n){n.element.setAttribute("class","data-column data-column-hover");var a=E(n.value),s=e;n.element.getAttribute("y")>s+5&&(s=Number(n.element.getAttribute("y"))-5),this.tooltip.show(s+i+8,t+r,a)}for(var o in this.columnsObject)this.columnsObject[o]===n||this.columnsObject[o].hoverProtected||this.columnsObject[o].element.setAttribute("class","data-column")}},i.prototype.__loseFocus__=function(){this.tooltip.hide();for(var t in this.columnsObject)this.columnsObject[t].hoverProtected||this.columnsObject[t].element.setAttribute("class","data-column")},i.prototype.__findRectAtPoint=function(t){t=Math.floor(t);var e;for(e in this.columnsObject){var i=this.columnsObject[e];if(t>=i.x1&&t<=i.x2)return i}},i.prototype.__tooltipHeightCalulator=function(t,e){var i=this.renderEngine.yRangeEstimator(t),r=(Math.floor.bind(Math),this.renderEngine.height-i);return r-=.05*this.renderEngine.height,r/this.renderEngine.height>.75&&(r-=.25*this.renderEngine.height),r},r.prototype=Object.create(e.prototype),r.prototype.renderData=function(t,e){var i,r,n,a,s;if(t)for(i=0,r=t.length;i<r;++i){n=t[i].sale,a=t[i].name;var o=t[i].profit||0;s=e(o);var h=0,l=this.renderEngine.xaxis.estimateRange(n),c=this.renderEngine.yaxis.estimateRange(a)+this.columnWidth/2,u=l;u<1&&(u=1);var d=this.renderEngine.drawRect(h,c,u,this.columnWidth,"data-column-cross",s);this.columnsObject.push({x1:Math.floor(d.getAttribute("x")),x2:Math.floor(Number(d.getAttribute("x"))+this.columnWidth),y:Math.floor(d.getAttribute("y")),value:a,element:d})}},n.prototype.getXRange=function(){for(var t=_(this.model.getMinX().year,this.model.getMinX().month),e=_(this.model.getMaxX().year,this.model.getMaxX().month),i=(e-t)/5,r=[];t<=e;)r.push(Math.round(t)),t+=i;return r},n.prototype.getXRangeOfVariable=function(t){var e,i,r,n=this.model.getY(t),a=[];for(e=0,i=n.length;e<i;++e)r=n[e],a[e]=_(r.year,r.month);return a},n.prototype.getYRangeOfVariable=function(t){var e,i,r,n=this.model.getY(t),a=[];for(e=0,i=n.length;e<i;++e)r=n[e],a[e]=r.value;return a},n.prototype.__getValueAtPosition=function(t,e){if(t){var i=this.model.getY(e);A(t);if(!(t<i[0].date||t>i[i.length-1].date))return R(0,i.length-1,t,i,this.model.interpolation)}},n.prototype.getColumnWidth=function(){var t=this.model.getWidth(),e=(this.model.getHeight(),this.model.getMaxPointsOfAllChart()),i=e+1;return Math.floor(t/(e+i))},n.prototype.render=function(t,e){var r,n;this.rootEl=document.getElementById(t),this.rootEl.innerHTML="",this.rootEl.setAttribute("class","pallete");var a=document.createElement("div");a.setAttribute("class","caption-box");var s=document.createElement("h2");s.setAttribute("class","caption");var o=document.createElement("h4");o.setAttribute("class","sub-caption"),a.appendChild(s),a.appendChild(o),s.innerHTML=this.model.getCaption(),o.innerHTML=this.model.getSubCaption(),this.rootEl.appendChild(a),this.numChartsRow=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.numChartsRow=Math.floor(this.numChartsRow/(this.model.getWidth()+.03*this.numChartsRow));var l=this.model.getAllVariables(),c=0,u=u?u:this.getColumnWidth();this.isChartLabelTop=l.length%this.numChartsRow!==0,this.renderEngineObject={};var p={height:this.model.getWidth(),width:this.model.getWidth()};({min:_(this.model.getMinX().year,this.model.getMinX().month),max:_(this.model.getMaxX().year,this.model.getMaxX().month)});for(var f in l)r=l[f],this.renderEngineObject[r]=new d(this,t,p,r,this.isChartLabelTop),n=this.renderEngineObject[r],n.attachAxisX(new g({height:p.height,width:p.width,range:this.model.getX(r),shrink:n.shiftRatioX,basicRange:!0,displayFn:w,readFn:function(t){return t=new Date(t),_(t.getYear(),t.getMonth())},alignment:"center-horizontal down"})),"population"===r&&console.log(this.model.getY(r)),n.attachAxisY(new m({height:p.height,width:p.width,range:this.model.getY(r),shrink:n.shiftRatioY,displayFn:C,readFn:function(t){return t.value},alignment:"left center-horizontal half-center-vertical"})),n.drawAxisX(),n.drawAxisY(),n.drawAxisYLabel(),n.chartLabel(),"column"===e.toLowerCase()?n.attachChart(new i(n,u)):n.attachChart(new h(n,u)),n.renderChart(this.getXRangeOfVariable(r),this.getYRangeOfVariable(r)),++c;this.__prepareArrange__(),this.__showLabels__()},n.prototype.__prepareArrange__=function(){var t,e,i,r,n=this;if(!this.storeSvgArray){this.storeSvgArray=[],this.storeSvgDimensionArray=[];for(t in this.renderEngineObject)this.storeSvgArray.push({svg:this.renderEngineObject[t].svg,key:t,data:this.model.getY(t),object:this.renderEngineObject[t]}),this.storeSvgDimensionArray.push(b(this.renderEngineObject[t].svg))}for(e=0,i=this.storeSvgArray.length;e<i;++e)r="position : absolute; top : "+n.storeSvgDimensionArray[e].top+"px;",r+="left : "+n.storeSvgDimensionArray[e].left+"px;",r+="margin-left : 0px",n.storeSvgArray[e].svg.setAttribute("style",r)},n.prototype.reverse=function(t){var e,i,r,n=this;for(this.storeSvgArray.reverse(),this.__hideLabels__(),e=0,i=n.storeSvgArray.length;e<i;++e)r="position : absolute; top : "+n.storeSvgDimensionArray[e].top+"px;",r+="left : "+n.storeSvgDimensionArray[e].left+"px;",r+="margin-left : 0px",n.storeSvgArray[e].svg.setAttribute("style",r);this.__showLabels__()},n.prototype.rearrange=function(t){var e,i,r,n=this,a=t;for(this.storeSvgArray.sort(function(t,e){return a(t.data)-a(e.data)}),this.__hideLabels__(),e=0,i=n.storeSvgArray.length;e<i;++e)r="position : absolute; top : "+n.storeSvgDimensionArray[e].top+"px;",r+="left : "+n.storeSvgDimensionArray[e].left+"px;",r+="margin-left : 0px",n.storeSvgArray[e].svg.setAttribute("style",r);this.__showLabels__()},n.prototype.__showLabels__=function(){var t,e,i=this;if(this.isChartLabelTop)for(t=0,e=i.storeSvgArray.length;t<this.numChartsRow&&t<e;++t)i.storeSvgArray[t].object.drawAxisXLabel(this.isChartLabelTop);else for(e=i.storeSvgArray.length,t=e-this.numChartsRow;t<e;++t)i.storeSvgArray[t].object.drawAxisXLabel(this.isChartLabelTop)},n.prototype.__hideLabels__=function(){var t,e,i=this;for(t=0,e=i.storeSvgArray.length;t<e;++t)i.storeSvgArray[t].object.removeAxisXLabel(this.getXRange())},a.prototype.render=function(t){var e,i=0,n={},a="",s="",o=[],h={},l=[],c=[],u={},g={},m={},y={},v={},x={};v={height:1*this.dimension.height,width:this.dimension.width},g={height:this.dimension.height,width:this.dimension.width/2},y={height:30,width:this.dimension.width},m={height:20,width:this.dimension.width},o=this.model.getPlotData(),e=this.dimension.height/(2*this.model.getMaxColumnCount()),n=new d(this,t,m,a),n.marginY*=1,n.marginX*=1,n.shiftRatioX*=1,n.shiftRatioY*=1,n.attachAxisX(new p(m,1,{min:0,max:100})),n.attachAxisY(new f(m,.8,["Product type &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Product"])),n.drawAxisYLabel("left-10px"),n.attachChart(new r(n,e)),n.renderChart(l,this.model.getColorByProfit.bind(this.model));for(s in this.model.getZones())s=this.model.getZones()[s],l=h[s],u[a]=new d(this,t,m,a),n=u[a],n.marginY*=1,n.marginX*=1,n.shiftRatioX*=1,n.shiftRatioY*=1,n.attachAxisX(new p(m,1,{min:0,max:100})),n.attachAxisY(new f(m,.8,[s])),n.drawAxisYLabel(),n.attachChart(new r(n,e)),n.renderChart(l,this.model.getColorByProfit.bind(this.model));for(a in o){h=o[a],c=this.model.getUniqueNames(h),n=new d(this,t,g,a,null,null,(!0)),n.marginY*=0,n.marginX*=0,n.shiftRatioX*=1,n.shiftRatioY*=1,n.attachAxisX(new p(g,1,{min:0,max:this.model.getMaxSale()})),n.drawAxisX(),n.attachAxisY(new f(g,.8,[a])),n.drawAxisY(),n.drawAxisXLabel(),n.drawAxisYLabel("right-10px right-10px"),n=new d(this,t,g,a,null,null,(!0)),n.marginY*=0,n.marginX*=0,n.shiftRatioX*=1,n.shiftRatioY*=1,n.attachAxisX(new p(g,1,{min:0,max:this.model.getMaxSale()})),n.drawAxisX(),n.attachAxisY(new f(g,.8,c)),n.drawAxisY(),n.drawAxisXLabel(),n.drawAxisYLabel("right-10px");Object.keys(o)[Object.keys(o).length-1]===a;for(s in this.model.getZones())s=this.model.getZones()[s],x=this.dimension,l=h[s],u[a]=new d(this,t,x,a,null,null,(!0)),n=u[a],n.marginY*=0,n.shiftRatioX*=0,n.marginX*=0,n.shiftRatioY*=1,n.attachAxisX(new p(x,1,{min:0,max:this.model.getMaxSale()})),n.drawAxisX(),n.attachAxisY(new f(x,.8,c)),n.drawAxisY(),n.drawAxisXLabel(),n.attachChart(new r(n,e)),n.renderChart(l,this.model.getColorByProfit.bind(this.model))}for(var i=0;i<this.numSvgs-2;++i)n=new d(this,t,this.dimension,a,(!0),i?"chart x-axis-only":"chart x-axis-only-first",(!0)),n.marginY*=3,n.attachAxisX(new p(this.dimension,1,{min:0,max:this.model.getMaxSale()})),n.drawAxisX(),n.attachAxisY(new f(this.dimension,.8,["uniqueNameList"])),n.drawAxisXLabel(),n.attachChart(new r(n,e)),n.renderChart(l,this.model.getColorByProfit.bind(this.model)),n.chartLabel("Sum of sales")},String.prototype["in"]=function(t,e){var i=0,r=t.length,e=e||function(t){return t};for(i=r;i--;)if((e(t[i])+"").toLowerCase()===this.valueOf().toLowerCase())return i;return!1};var y=function(t,e,i){var r=0,n=i||t.length;for(r=n;r--;)i?t.push(e):t[r]=e},v=function(t,e){var i=0,r=t.length,n=[];for(i=0;i<r;++i)e[i]&&n.push(t[i]);return n},x=function(t,e){return t=_(t.year,t.month),e=_(e.year,e.month),t-e},b=function(t){var e=t,i=0,r=0;do i+=t.offsetTop||0,r+=t.offsetLeft||0,t=t.offsetParent;while(t);return 0===i||0===r?s(e):{top:i,left:r}},_=function(t,e){return 12*t+e},A=function(t){return{year:Math.floor(t/12),month:t%12}},w=function(t){var e=A(t).year,i=A(t).month,r=["Jan","Feb","Mar","Apr","May","June","Jul","Aug","Sep","Oct","Nov","Dec"];return e%=100,e<10?r[i]+" '0"+e:r[i]+" '"+e},C=function(t){if("number"!=typeof t)return t;var e,i=M(t),r="";return i>=13?(r="t",e=12):i>=10?(r="b",e=9):i>=7?(r="m",e=6):i>=4?(r="k",e=3):(r="",e=0),t/=Math.pow(10,e),t*=100,t=Math.round(t),t/=100,t+r},E=function(t){var e,i=M(t),r="";i>=13?(r=" trillion",e=12):i>=10?(r=" billion",e=9):i>=7?(r=" million",e=6):i>=4?(r=" thousand",e=3):(r="",e=0);var n=t/Math.pow(10,e);return Math.round(100*n)/100+r},M=function(t){t=t<0?t*-1:t;for(var e=0;t>0;)++e,t=Math.floor(t/10);return e},R=function(t,e,i,r,n){var a;if(e-t===1){if(r[t].date===i&&(a=r[t].value),r[e].date===i&&(a=r[e].value),n){var s=(r[e].value-r[t].value)/(r[e].date-r[t].date),o=r[t].value-r[t].date*s;a=i*s+o}else a=i-r[t].date>r[e].date-i?r[e].value:r[t].value;return{value:a}}var h=Math.floor((t+e)/2);return r[h].date===i?{value:r[h].value}:i>r[h].date?R(h,e,i,r,n):R(t,h,i,r,n)},L=function(t){if(!t||"object"!=typeof t)return[];if(t.basic)return Y(t);var e,i=[],r=X({min:t.min,max:t.max}),n=r.min,a=r.max,s=0,o=0,h=0,l=0,c=0,u=0,d=0,u=a,i=[];if(n===a)return i=[2*n,n,0];for(;u>99||u<-99;)u/=10,++d;for(c=Math.floor(100*n/Math.pow(10,d))/100;c>99||c<-99;)c/=10,u/=10,++d;for(h=u-c,l=h<=.3?.05:h<=1?.2:h<=3?.5:h<=6?1:h<=12?2:h<=20?4:h<=30?5:h<=40?7:h<=50?10:h<=80?15:20,s=Math.floor(c/l)*l,o=Math.ceil(u/l)*l,l*=Math.pow(10,d),s*=Math.pow(10,d),o*=Math.pow(10,d),e=s;e<=o;)e=Math.round(100*e)/100,i.push(e),e+=l;return i},X=function(t){if(t){var e=t.min,i=t.max;if(e===i)return{min:e-1,max:i+1};for(var r=i-e,n=i-e,a=M(r);n<1;)a-=1,n*=10;var s=5*Math.pow(10,a-2);if(e=Math.floor(e/s)*s,r/i>.1){var o=Math.pow(10,M(i)-2);s=s>o?s:o}return i=Math.ceil(i/s)*s,{min:e,max:i}}},Y=function(t){if(!t||"object"!=typeof t)return[];divisions=t.divisions||5,--divisions;var e=0,i=t.min,r=t.max,n=r-i,a=0,s=[];for(e=0;e<=divisions;++e)a=e/divisions*n+i,s.push(a);return s},O=function(t,e){var i=0,r=t.length,n=[];for(i=0;i<r;++i)n.push(e(t[i]));return n};h.prototype=Object.create(e.prototype),h.prototype.renderData=function(t,e){var i,r,n,a,s,o;for(i=1,r=t.length;i<r;++i)n=t[i],a=t[i-1],s=e[i],o=e[i-1],this.renderEngine.plotLine(a,o,n,s);for(i=0,r=t.length;i<r;++i){n=t[i],s=e[i];var h=this.renderEngine.plotCircle(n,s);this.plotCirclesObject[Math.floor(h.getAttribute("cx"))]={circle:h,y:h.getAttribute("cy")}}},h.prototype.behave=function(t){t===-1||this.__flagMouseDown__?this.__destroyVerticalLine():this.__syncVerticalLine__(t)},h.prototype.highlight=function(t,e,i,r){var n,a;for(n in this.plotCirclesObject)a=this.plotCirclesObject[n],n>=t-this.renderEngine.plotCircleRadius&&n<=i+this.renderEngine.plotCircleRadius&&a.y-this.renderEngine.plotCircleRadius<=r&&a.y+this.renderEngine.plotCircleRadius>=e?(a.hoverProtected=!0,a.circle.setAttribute("class","plot-circle plot-circle-hover")):delete a.hoverProtected},h.prototype.__syncVerticalLine__=function(t){var e=b(this.renderEngine.svg).top,i=b(this.renderEngine.svg).left;if(!(t<this.renderEngine.marginX)){this.verticalLine||(this.verticalLine=document.createElementNS("http://www.w3.org/2000/svg","line"),this.renderEngine.svg.appendChild(this.verticalLine));var r=this.renderEngine.getRatio(t),n=this.renderEngine.engine.__getValueAtPosition(r,this.renderEngine.key);if(n){var a=E(n.value);a+=" \n "+w(r);var s=this.__tooltipHeightCalulator(n.value,this.renderEngine.key);this.tooltip.show(e+s,t+2*this.renderEngine.plotCircleRadius+i,a);var o=this.__findCircleAtPoint(t);o&&o.setAttribute("class","plot-circle plot-circle-hover");for(var h in this.plotCirclesObject)this.plotCirclesObject[h].circle===o||this.plotCirclesObject[h].hoverProtected||this.plotCirclesObject[h].circle.setAttribute("class","plot-circle")}var l=this.renderEngine.height*(1-this.renderEngine.shiftRatioY)-this.renderEngine.marginY;this.verticalLine.setAttribute("x1",t-2),this.verticalLine.setAttribute("y1",l),this.verticalLine.setAttribute("x2",t),this.verticalLine.setAttribute("y2",this.renderEngine.height-this.renderEngine.marginY),this.verticalLine.setAttribute("class","vertical-line")}},h.prototype.__destroyVerticalLine=function(){this.verticalLine&&(this.renderEngine.svg.removeChild(this.verticalLine),this.verticalLine=void 0,this.tooltip.hide());for(var t in this.plotCirclesObject)this.plotCirclesObject[t].hoverProtected||this.plotCirclesObject[t].circle.setAttribute("class","plot-circle")},h.prototype.__findCircleAtPoint=function(t){t=Math.floor(t);var e;for(e=t-this.plotCircleRadius;e<=t+this.plotCircleRadius;++e)if(this.plotCirclesObject[e])return this.plotCirclesObject[e].circle},h.prototype.__tooltipHeightCalulator=function(t,e){var i=this.renderEngine.yaxis.estimateRange(t),r=(Math.floor.bind(Math),this.renderEngine.height-i);return r-=.05*this.renderEngine.height,r/this.renderEngine.height>.75&&(r-=.25*this.renderEngine.height),r},l.prototype.getMaxPointsOfAllChart=function(){var t=0;for(var e in this.data.category)this.data.category[e].length>t&&(t=this.data.category[e].length);return t},l.prototype.getType=function(){return this.type},l.prototype.getMinX=function(){return this.data.dateArray[0]},l.prototype.getMaxX=function(){return this.data.dateArray[this.data.dateArray.length-1]},l.prototype.getMinY=function(t){var e,i,r=this.data.category[t],n=r[0].value;for(e=0,i=r.length;e<i;++e)n>r[e].value&&(n=r[e].value);return n},l.prototype.getMaxY=function(t){var e,i,r=this.data.category[t],n=r[0].value;for(e=0,i=r.length;e<i;++e)n<r[e].value&&(n=r[e].value);return n},l.prototype.getX=function(){return this.data.dateArray},l.prototype.getY=function(t){return this.data.category[t]},l.prototype.getWidth=function(){return this.data.dimensions.width},l.prototype.getHeight=function(){return this.data.dimensions.height},l.prototype.getAllVariables=function(){return Object.keys(this.data.category)},l.prototype.getCaption=function(){return this.data.caption},l.prototype.getSubCaption=function(){return this.data.subcaption},c.prototype.__crunch__=function(){var t=0,e=0,i={},r={},n="",a="",s={},o=0,h=0,l=this.data;for(this.dataStore={},this.max={},this.max.sale=0,this.max.profit=0,this.min={},this.min.profit=0,this.uniqueZones=[],this.productsPerCategory={},t=0,e=l.dataset.length;t<e;++t)i=l.dataset[t],this.dataStore[i.category]=this.dataStore[i.category]||{},this.dataStore[i.category][i.zone]=this.dataStore[i.category][i.zone]||[],this.dataStore[i.category][i.zone].push({name:i.name,sale:i.sale,profit:i.profit}),this.productsPerCategory[i.category]=this.productsPerCategory[i.category]||[],this.productsPerCategory[i.category].indexOf(i.name)===-1&&this.productsPerCategory[i.category].push(i.name),this.uniqueZones.indexOf(i.zone)===-1&&this.uniqueZones.push(i.zone),i.sale>this.max.sale&&(this.max.sale=i.sale),i.profit>this.max.profit&&(this.max.profit=i.profit),i.profit<this.min.profit&&(this.min.profit=i.profit);for(n in this.dataStore){s=this.dataStore[n];for(a in s){for(r=s[a],o=0,h=0,t=0,e=r.length;t<e;++t)i=r[t],o+=i.sale,h+=i.profit;o>this.max.sale&&(this.max.sale=o),h>this.max.profit&&(this.max.profit=h),h<this.min.profit&&(this.min.profit=h),r.push({name:"Total",sale:o,profit:h})}}},c.prototype.getUniqueNames=function(t){var e=0,i=0,r="",n=[],a=[];for(r in t)for(n=t[r],e=0,i=n.length;e<i;++e)a.indexOf(n[e].name)===-1&&a.push(n[e].name);return a.sort(function(t,e){return(t<e?-1:t>e?1:0)*-1}),a},c.prototype.getMaxColumnCount=function(){var t="",e=0;for(t in this.dataStore)this.getUniqueNames(this.dataStore[t]).length>e&&(e=this.getUniqueNames(this.dataStore[t]).length);return e},c.prototype.getMaxSale=function(){return this.max.sale},c.prototype.getZones=function(){return this.uniqueZones.sort(function(t,e){return t===e?0:t>e?1:-1}),this.uniqueZones},c.prototype.getPlotData=function(){return this.dataStore},c.prototype.getColorByProfit=function(t){var e,i,r=this.min.profit,n=this.max.profit;if(t>0)var a=t/n;else var a=-t/r;a<0&&(a*=-1),t>0?(e=this.data.colorRange[0],i=this.data.colorRange[1]):(e=this.data.colorRange[2],i=this.data.colorRange[3]);var s=function(t){return t=t.toString(16),t.length<=1?"0"+t:t},o=Math.ceil(parseInt(e.substring(0,2),16)*a+parseInt(i.substring(0,2),16)*(1-a)),h=Math.ceil(parseInt(e.substring(2,4),16)*a+parseInt(i.substring(2,4),16)*(1-a)),l=Math.ceil(parseInt(e.substring(4,6),16)*a+parseInt(i.substring(4,6),16)*(1-a)),c=s(o)+s(h)+s(l);return"#"+c},u.prototype.show=function(t,e,i){this.style="position:absolute;top:"+t+"px;left:"+e+"px;visibility:",this.style+="visible",this.toolEl.innerHTML=i,this.toolEl.setAttribute("style",this.style)},u.prototype.hide=function(){var t=";visibility: hidden";this.toolEl.setAttribute("style",this.style+t)},d.prototype.attachAxisX=function(t){this.xaxis=t},d.prototype.attachAxisY=function(t){this.yaxis=t},d.prototype.drawAxisX=function(t){this.xaxis.plotAxis(this),this.xaxis.plotTicks(this)},d.prototype.drawAxisY=function(t){this.yaxis.plotAxis(this),this.yaxis.plotTicks(this),this.yaxis.placeDivBoxes(this)},d.prototype.drawAxisXLabel=function(t){this.xaxis.placeLabel(this,t)},d.prototype.drawAxisYLabel=function(t){this.yaxis.placeLabel(this,t)},d.prototype.removeAxisXLabel=function(){this.xaxis.removeLabel(this)},d.prototype.removeElement=function(t){return t?(this.svg.removeChild(t),t):t},d.prototype.__dragListener__=function(){function t(){a=b(i.svg).left,s=b(i.svg).top}var e,i=this,r={},n={},a=b(this.svg).left,s=b(this.svg).top,o=0;this.svg.addEventListener("mousedown",function(e){t();var i=new CustomEvent("selectionmousedown",{detail:{x:e.clientX-a,y:e.pageY-s}});document.dispatchEvent(i)}),this.svg.addEventListener("mouseup",function(e){t();var i=new CustomEvent("selectionmouseup",{detail:{x:e.clientX-a,y:e.pageY-s}});document.dispatchEvent(i)}),this.svg.addEventListener("mousemove",function(e){t();var i=new CustomEvent("selectionmousemove",{detail:{x:e.clientX-a,y:e.pageY-s}});document.dispatchEvent(i)}),document.addEventListener("selectionmousedown",function(t){e=b(i.svg).top+i.height-i.marginY,s=i.height-i.marginY-i.height*i.shiftRatioY,i.__sigMouseDown__(),(0===o||2===o)&&t.detail.x>=i.marginX&&t.detail.y>=s&&t.detail.y<=e&&(i.__boxDestroy__(),r.x=t.detail.x,r.y=t.detail.y,o=1),2===o&&(o=0,i.__boxDestroy__())}),document.addEventListener("selectionmouseup",function(t){s=i.height-i.marginY-i.height*i.shiftRatioY,i.__sigMouseUp__(),1===o&&(o=2,i.__boxRemoveFocus__())}),document.addEventListener("selectionmousemove",function(t){s=i.height-i.marginY-i.height*i.shiftRatioY,1===o&&t.detail.x>=i.marginX&&t.detail.y>=s&&t.detail.y<=e&&(n.x=t.detail.x,n.y=t.detail.y,i.__drawBox__(r,n))})},d.prototype.__sigMouseDown__=function(){var t=this;t.attachedChart.__flagMouseDown__=!0},d.prototype.__sigMouseUp__=function(){var t=this;t.attachedChart.__flagMouseDown__=!1},d.prototype.__boxDestroy__=function(){var t=this;t.selectionBox&&(t.svg.removeChild(t.selectionBox),delete t.selectionBox),t.attachedChart.highlight(-1,-1,-1,-1)},d.prototype.__boxRemoveFocus__=function(){var t=this;t.selectionBox&&t.selectionBox.setAttribute("style","opacity: 0")},d.prototype.__drawBox__=function(t,e){var i=this;i.selectionBox||(i.selectionBox=document.createElementNS("http://www.w3.org/2000/svg","rect"),i.svg.appendChild(i.selectionBox));var r=(b(this.svg).left,b(this.svg).top,t.x),n=t.y,a=e.x-t.x,s=e.y-t.y;a<0&&s<0&&(n=e.y,s*=-1,r=e.x,a*=-1),a<0&&s>=0&&(r=e.x,a*=-1),a>=0&&s<0&&(n=e.y,s*=-1),i.selectionBox.setAttribute("x",r),i.selectionBox.setAttribute("y",n),i.selectionBox.setAttribute("width",a),i.selectionBox.setAttribute("height",s),i.selectionBox.setAttribute("style","opacity: 0.2"),i.selectionBox.setAttribute("class","selection-box"),i.attachedChart.highlight(r,n,r+a,n+s)},d.prototype.attachChart=function(t){this.attachedChart=t},d.prototype.renderChart=function(t,e){this.attachedChart.renderData(t,e)},d.prototype.convert=function(t,e){return{x:t+this.marginX,y:this.height-(e+this.marginY)}},d.prototype.__shiftX=function(t){return t*this.shiftRatioX},d.prototype.__shiftY=function(t){return t*this.shiftRatioY},d.prototype.drawLine=function(t,e,i,r,n){var a=this.convert(t,e),s=this.convert(i,r),o=document.createElementNS("http://www.w3.org/2000/svg","line");return o.setAttribute("x1",a.x),o.setAttribute("y1",a.y),o.setAttribute("x2",s.x),o.setAttribute("y2",s.y),n&&o.setAttribute("class",n),this.svg.appendChild(o),o},d.prototype.drawRect=function(t,e,i,r,n,a){var s=this.convert(t,e);s.x<this.marginX&&(s.x=this.marginX);var o=document.createElementNS("http://www.w3.org/2000/svg","rect");return o.setAttribute("x",s.x),o.setAttribute("y",s.y),o.setAttribute("width",i),o.setAttribute("height",r),o.style.fill=a,n&&o.setAttribute("class",n),this.svg.appendChild(o),o},d.prototype.__drawCircle=function(t,e,i,r){var n=this.convert(t,e),a=document.createElementNS("http://www.w3.org/2000/svg","circle");return a.setAttribute("cx",n.x),a.setAttribute("cy",n.y),a.setAttribute("r",i),a.setAttribute("class",r),this.svg.appendChild(a),a},d.prototype.chartLabel=function(t){var e,i,r,n,a,s=this.key;this.isLabelTop?(i=-1*this.marginY/3,r=0,a=this.width*this.shiftRatioX+this.marginX-1,n=.1*this.height):(i=this.height-this.marginY-1,r=0,a=this.width*this.shiftRatioX+this.marginX-1,n=.1*this.height),t||this.drawRect(r,i,a,n,"chart-label-back"),e=this.__placeText(a/2,i,t||s.toUpperCase(),"chart-label","","down center-horizontal center-vertical")},d.prototype.getRatio=function(t){var e,i=this.xaxis.estimateRange(this.xaxis.max)-this.xaxis.estimateRange(this.xaxis.min),r=t-this.xaxis.estimateRange(this.xaxis.min)-this.marginX,n=r/i,a=this.xaxis.max-this.xaxis.min;return n>=0&&n<=1&&(e=n*a+this.xaxis.min),Math.round(e)},d.prototype.__placeText=function(t,e,i,r,n,a){var s,o,h=document.createElementNS("http://www.w3.org/2000/svg","text");if(t=this.convert(t,e).x,e=this.convert(t,e).y,h.setAttribute("x",t),h.setAttribute("y",e),r&&h.setAttribute("class",r),
n){var l="rotate(";l+=n,l+=" ",l+=t+","+e,l+=")",h.setAttribute("transform",l)}if(h.innerHTML=i,this.svg.appendChild(h),a){a=a.split(" ");for(s in a)o=a[s],o&&"center-horizontal"===o&&(t-=h.clientWidth/2),o&&"down"===o&&(e+=+h.clientHeight),o&&"center-vertical"===o&&(e+=h.clientHeight/2),o&&"half-center-vertical"===o&&(e+=h.clientHeight/4),o&&"half-right"===o&&(t+=h.clientWidth/2),o&&"right-10px"===o&&(t+=10),o&&"up"===o&&(e-=+h.clientHeight),o&&"left-10px"===o&&(t-=10),o&&"half-left"===o&&(t-=h.clientWidth/2),o&&"left"===o&&(t-=h.clientWidth),h.setAttribute("x",t),h.setAttribute("y",e)}return h},d.prototype.plotLine=function(t,e,i,r,n){t=this.xaxis.estimateRange(t),i=this.xaxis.estimateRange(i),e=this.yaxis.estimateRange(e),r=this.yaxis.estimateRange(r),n=n||"chart-line",this.drawLine(t,e,i,r,n)},d.prototype.plotCircle=function(t,e){t=this.xaxis.estimateRange(t),e=this.yaxis.estimateRange(e);var i="plot-circle";return this.__drawCircle(t,e,this.plotCircleRadius,i)},g.prototype=Object.create(t.prototype),g.prototype.constructor=g,p.prototype=Object.create(t.prototype),p.prototype.constructor=p,p.prototype.__getRangeArray__=function(){var t,e=[],i=this.__beautifyLimits__(),r=i.min,n=i.max,a=0,s=0,o=0,h=0,l=0,c=0,u=0,c=n;if(this.rangeArray)return this.rangeArray;if(r===n)return this.rangeArray=[2*r,r,0],this.rangeArray;for(;c>99||c<-99;)c/=10,++u;for(l=Math.floor(100*r/Math.pow(10,u))/100;l>99||l<-99;)l/=10,c/=10,++u;for(o=c-l,h=o<=.3?.05:o<=1?.2:o<=3?.5:o<=6?1:o<=12?2:o<=20?4:o<=30?5:o<=40?7:o<=50?10:o<=80?15:20,a=Math.floor(l/h)*h,s=Math.ceil(c/h)*h,h*=Math.pow(10,u),a*=Math.pow(10,u),s*=Math.pow(10,u),t=a;t<=s;)t=Math.round(100*t)/100,e.push(t),t+=h;return this.rangeArray=e,this.min=this.rangeArray[0],this.max=this.rangeArray[this.rangeArray.length-1],e},p.prototype.__beautifyLimits__=function(){var t=this.min,e=this.max;if(t===e)return{min:t,max:e};for(var i=e-t,r=e-t,n=M(i);r<1;)n-=1,r*=10;var a=5*Math.pow(10,n-2);if(t=Math.floor(t/a)*a,i/e>.1){var s=Math.pow(10,M(e)-2);a=a>s?a:s}return e=Math.ceil(e/a)*a,{min:t,max:e}},p.prototype.placeLabel=function(t,e){var i,r=0,n=0,a=0,s=0,o="",h=this.__getRangeArray__(),l="center-horizontal down";for(this.labelArray||(this.labelArray=[]),e&&(s=t.yaxis.shrink*this.height,l="center-horizontal up"),r=0,n=h.length;r<n;++r)0!==r&&r!==h.length-1&&(i=Math.round(h[r]),a=this.estimateRange(i),o=C(i),this.labelArray[r]=t.__placeText(a,s,o,"axis-label YAxisCross-label",null,l))},m.prototype=Object.create(t.prototype),m.prototype.constructor=m,m.prototype.placeDivBoxes=function(t){var e,i=0,r=0,n=t.xaxis.estimateRange(0),a=5,s=t.xaxis.max,o=this.estimateRange(this.rangeArray[1])-this.estimateRange(this.rangeArray[0]),h=this.__getRangeArray__();if(this.isVertical)for(i=1,r=h.length;i<r;++i)e=Math.round(h[i]),a=this.estimateRange(e),t.drawRect(n,a,s,o,"div-lines")},f.prototype=Object.create(t.prototype),f.prototype.constructor=f,f.prototype.estimateRange=function(t){"string"==typeof t&&(t=this.rangeArray.indexOf(t));var e=(t+.5)/this.rangeArray.length;return this.shrink*e*this.height},f.prototype.__getRangeArray__=function(t){if(this.rangeArray)return this.rangeArray},f.prototype.placeLabel=function(t,e){var i,r=0,n=0,a=0,s=0,o="",h=this.__getRangeArray__(),e=e+" half-center-vertical";if(this.labelArray||(this.labelArray=[]),h)for(r=0,n=h.length;r<n;++r)i=h[r],s=this.estimateRange(r),o=i,this.labelArray[r]=t.__placeText(a,s,o,"axis-label XAxisCross-label",null,e)},f.prototype.removeLabel=function(t){var e,i=0,r=0;if(this.labelArray)for(i=0,r=this.labelArray.length;i<r;++i)e=this.labelArray[i],e&&(t.removeElement(e),this.labelArray[i]=void 0)},f.prototype.placeDivBoxes=function(t){},f.prototype.plotTicks=function(t){var e,i,r,n,a,s,o,h=this.__getRangeArray__();if(h)for(e=0,i=h.length;e<i;++e)r=h[e],n=-6,a=0,s=this.estimateRange(e),o=s,t.drawLine(n,s,a,o,"ticks")}}();